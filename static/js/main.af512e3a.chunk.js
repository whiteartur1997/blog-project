(this["webpackJsonpblog-project"]=this["webpackJsonpblog-project"]||[]).push([[0],{101:function(t,e,n){},102:function(t,e,n){},128:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),a=n(10),c=n.n(a),s=(n(101),n(102),n(17)),i=n(24),l=n.n(i),u=n(35),d=n(67),p=n(13),b=n(80),j=n.n(b).a.create({baseURL:"https://bloggy-api.herokuapp.com",withCredentials:!0,headers:{"Content-Type":"application/json"}}),m=function(){return j.get("/posts")},h=function(t){return j.get("/posts/".concat(t,"?_embed=comments"))},O=function(t,e){return j.post("/posts",{title:t,body:e})},f=function(t){var e=t.id,n=t.title,r=t.body;return j.put("/posts/".concat(e),{title:n,body:r})},x=function(t){return j.delete("/posts/".concat(t))},v=function(t,e){return j.post("/comments",{postId:t,comment:e})},y={isInitializing:!0,isLoading:!1,posts:[],postData:null,modalIsOpen:!1,error:null},g=function(t){return function(){var e=Object(u.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n(k(!0)),e.next=4,x(t);case 4:n(C(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(N(e.t0.message));case 10:return e.prev=10,n(k(!1)),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(t){return e.apply(this,arguments)}}()},T=function(t){return{type:"SET-POSTS",posts:t}},S=function(t){return{type:"SET-POST",post:t}},D=function(t){return{type:"ADD-POST",post:t}},w=function(t){return{type:"EDIT-POST",post:t}},C=function(t){return{type:"REMOVE-POST",postId:t}},E=function(t){return{type:"ADD-COMMENT",post:t}},I=function(t){return{type:"SET-INIT",init:t}},k=function(t){return{type:"SET-LOADING",loading:t}},N=function(t){return{type:"SET-ERROR",error:t}},P=n(172),A=n(173),B=n(171),F=n(161),M=n(164),R=n(166),W=n(167),L=n(168),z=n(169),q=n(34),V=n(3),G=Object(F.a)({root:{maxWidth:345,margin:"20px"},leftAlign:{textAlign:"left"},postTitle:{textDecoration:"none"}}),J=function(t){var e=t.post,n=G(),r=Object(s.b)();return Object(V.jsxs)(M.a,{className:n.root,children:[Object(V.jsxs)(R.a,{children:[Object(V.jsx)(q.b,{to:{pathname:"/posts/".concat(e.id),state:{modalIsOpenProp:!1}},children:Object(V.jsx)(W.a,{gutterBottom:!0,variant:"h5",component:"h2",style:{textDecoration:"none"},className:"".concat(n.leftAlign," ").concat(n.postTitle),children:e.title})}),Object(V.jsx)(W.a,{variant:"body2",color:"textSecondary",component:"p",className:n.leftAlign,children:e.body})]}),Object(V.jsxs)(L.a,{children:[Object(V.jsx)(z.a,{size:"small",color:"primary",children:Object(V.jsx)(q.b,{style:{textDecoration:"none"},to:{pathname:"/posts/".concat(e.id),state:{modalIsOpenProp:!0}},children:"Edit"})}),Object(V.jsx)(z.a,{onClick:function(){r(g(e.id))},size:"small",color:"secondary",children:"Delete"})]})]})},H=n(170),U=function(){var t=Object(s.c)((function(t){return t.posts}));return Object(V.jsx)(H.a,{container:!0,direction:"row",justify:"center",alignItems:"center",children:t.map((function(t){return Object(V.jsx)(J,{post:t},t.id)}))})},X=n(179),Y=n(174),_=n(37),K=Object(F.a)((function(t){return Object(X.a)({root:{display:"flex",flexDirection:"column",alignItems:"flex-start",flexWrap:"wrap",padding:"30px"},form:{display:"flex",flexDirection:"column",width:"80%"},textFieldTitle:{margin:t.spacing(1),width:"25ch",maxWidth:"80%"},textFieldBody:{margin:t.spacing(1),width:"90%"},button:{maxWidth:"30%"}})})),Q=function(){var t=Object(s.b)(),e=Object(_.a)({initialValues:{title:"",body:""},validate:function(t){var e={};return t.title?t.title.length>30&&(e.title="Title should be shorter than 30 symbols!"):e.title="Title is required!",t.body||(e.body="Body text is required"),e},onSubmit:function(n){var r,o;t((r=n.title,o=n.body,function(){var t=Object(u.a)(l.a.mark((function t(e){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e(k(!0)),t.next=4,O(r,o);case 4:n=t.sent,e(D(n.data)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e(N(t.t0.message));case 11:return t.prev=11,e(k(!1)),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}())),e.resetForm()}}),n=K();return Object(V.jsxs)(M.a,{className:n.root,children:[Object(V.jsx)(W.a,{variant:"h3",gutterBottom:!0,children:"Write new post"}),Object(V.jsxs)("form",{onSubmit:e.handleSubmit,className:n.form,children:[Object(V.jsx)(Y.a,{label:"Title",placeholder:"Post title",className:n.textFieldTitle,id:"title",name:"title",value:e.values.title,onChange:e.handleChange,error:e.touched.title&&Boolean(e.errors.title),helperText:e.touched.title&&e.errors.title}),Object(V.jsx)(Y.a,{multiline:!0,rows:6,placeholder:"Type something...",className:n.textFieldBody,id:"body",name:"body",value:e.values.body,onChange:e.handleChange,error:e.touched.body&&Boolean(e.errors.body),helperText:e.touched.body&&e.errors.body}),Object(V.jsx)(z.a,{className:n.button,variant:"contained",color:"primary",type:"submit",children:"Add post"})]})]})},Z=n(8),$=n(68),tt=n(176),et=Object(F.a)((function(t){return Object(X.a)({paper:{position:"absolute",top:"50%",left:"50%",transform:"translateY(-50%) translateX(-50%)",width:"80%",backgroundColor:t.palette.background.paper,border:"2px solid #000",boxShadow:t.shadows[5],padding:t.spacing(2,4,3),"& form":{display:"flex",flexDirection:"column",justifyContent:"flex-start","& div":{display:"flex",justifyContent:"space-between"}}},textField:{margin:"20px 0"},button:{maxWidth:"30%"}})})),nt=function(t){var e=Object(s.b)(),n=et(),r=Object(_.a)({initialValues:{title:t.postData.title,body:t.postData.body},validate:function(t){var e={};return t.title?t.title.length>30&&(e.title="Title should be shorter than 30 symbols!"):e.title="Title is required!",t.body||(e.body="Body text is required"),e},onSubmit:function(n){var o;e((o={id:t.postData.id,body:n.body,title:n.title},function(){var t=Object(u.a)(l.a.mark((function t(e,n){var r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e(k(!0)),t.next=4,f(o);case 4:r=t.sent,(a=n().postData)&&(a=Object(p.a)(Object(p.a)({},r.data),{},{comments:a.comments})),e(w(a)),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),e(N(t.t0.message));case 13:return t.prev=13,e(k(!1)),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[0,10,13,16]])})));return function(e,n){return t.apply(this,arguments)}}())),t.closeModal(),r.resetForm()}}),o=Object(V.jsxs)("div",{className:n.paper,children:[Object(V.jsx)(W.a,{variant:"h4",gutterBottom:!0,children:"Edit post"}),Object(V.jsxs)("form",{onSubmit:r.handleSubmit,children:[Object(V.jsx)(Y.a,{className:n.textField,label:"Title",placeholder:"Post title",id:"title",name:"title",value:r.values.title,onChange:r.handleChange,error:r.touched.title&&Boolean(r.errors.title),helperText:r.touched.title&&r.errors.title}),Object(V.jsx)(Y.a,{className:n.textField,label:"Post body",multiline:!0,rows:6,placeholder:"Type something...",id:"body",name:"body",value:r.values.body,onChange:r.handleChange,error:r.touched.body&&Boolean(r.errors.body),helperText:r.touched.body&&r.errors.body}),Object(V.jsxs)("div",{children:[Object(V.jsx)(z.a,{className:n.button,variant:"contained",color:"primary",type:"submit",children:"Edit post"}),Object(V.jsx)(z.a,{onClick:t.closeModal,className:n.button,variant:"contained",color:"secondary",children:"Cancel"})]})]})]});return Object(V.jsx)(tt.a,{onClose:t.closeModal,open:t.open,children:o})},rt=Object(F.a)({leftAlign:{textAlign:"left"},comment:{margin:"10px 0"}}),ot=function(){var t,e=Object(Z.g)(),n=!1;(null===(t=e.state)||void 0===t?void 0:t.modalIsOpenProp)&&(n=e.state.modalIsOpenProp);var o=Object(r.useState)(n),a=Object($.a)(o,2),c=a[0],i=a[1],p=rt(),b=Object(s.b)(),j=Object(Z.h)().postId,m=Object(s.c)((function(t){return t.postData})),O=Object(r.useState)(!1),f=Object($.a)(O,2),x=f[0],y=f[1],T=Object(_.a)({initialValues:{comment:""},validate:function(t){var e={};return t.comment||(e.comment="Title is required!"),e},onSubmit:function(t){b(function(t,e){return function(){var n=Object(u.a)(l.a.mark((function n(r,o){var a,c;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=o().postData,n.prev=1,r(k(!0)),n.next=5,v(t,e);case 5:c=n.sent,a&&(a.comments=[].concat(Object(d.a)(a.comments),[c.data]),r(E(a))),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),r(N(n.t0.message));case 12:return n.prev=12,r(k(!1)),n.finish(12);case 15:case"end":return n.stop()}}),n,null,[[1,9,12,15]])})));return function(t,e){return n.apply(this,arguments)}}()}(+j,t.comment)),T.resetForm()}});return Object(r.useEffect)((function(){return b(function(t){return function(){var e=Object(u.a)(l.a.mark((function e(n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n(k(!0)),e.next=4,h(t);case 4:r=e.sent,n(S(r.data)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n(N(e.t0.message));case 11:return e.prev=11,n(k(!1)),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}()}(j)),function(){b(S(null))}}),[j,b]),x?Object(V.jsx)(Z.a,{to:"/posts"}):Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(B.a,{className:p.leftAlign,fixed:!0,children:[Object(V.jsx)(q.b,{to:"/posts",children:"Back to posts"}),Object(V.jsxs)("div",{children:[Object(V.jsx)(W.a,{variant:"h3",component:"h3",children:m&&m.title}),Object(V.jsx)(z.a,{onClick:function(){i(!0)},color:"primary",children:"Edit"}),Object(V.jsx)(z.a,{onClick:function(){b(g(+j)),y(!0)},color:"secondary",children:"Delete"})]}),Object(V.jsx)(W.a,{component:"p",children:m&&m.body}),Object(V.jsx)(W.a,{variant:"h6",component:"h6",children:m&&"Comments:"}),m&&m.comments.length>0?m&&m.comments.map((function(t,e){return Object(V.jsx)(M.a,{className:p.comment,variant:"outlined",children:Object(V.jsxs)(R.a,{children:[Object(V.jsx)(W.a,{children:"Comment "+ ++e}),Object(V.jsx)(W.a,{color:"textSecondary",children:t.comment})]})},t.id)})):Object(V.jsx)(W.a,{component:"p",gutterBottom:!0,children:"No comments yet. Write the first!"}),Object(V.jsxs)("form",{onSubmit:T.handleSubmit,children:[Object(V.jsx)(Y.a,{id:"comment",name:"comment",label:"Add Comment",style:{cursor:"pointer"},placeholder:"What do you think?",value:T.values.comment,onChange:T.handleChange,error:T.touched.comment&&Boolean(T.errors.comment),helperText:T.touched.comment&&T.errors.comment,fullWidth:!0,margin:"normal"}),Object(V.jsx)(z.a,{style:{cursor:"pointer"},variant:"contained",color:"primary",type:"submit",children:"Add comment"})]})]}),c&&m&&Object(V.jsx)(nt,{closeModal:function(){i(!1)},postData:m,open:c})]})},at=n(175),ct=n(178);function st(t){return Object(V.jsx)(at.a,Object(p.a)({elevation:6,variant:"filled"},t))}function it(){var t=Object(s.c)((function(t){return t.error})),e=Object(s.b)(),n=function(t,n){"clickaway"!==n&&e(N(null))};return Object(V.jsx)(ct.a,{open:!!t,autoHideDuration:6e3,onClose:n,children:Object(V.jsx)(st,{onClose:n,severity:"error",children:t})})}function lt(){var t=Object(s.b)(),e=Object(s.c)((function(t){return t.isInitializing})),n=Object(s.c)((function(t){return t.isLoading}));return Object(r.useEffect)((function(){t(function(){var t=Object(u.a)(l.a.mark((function t(e){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m();case 3:n=t.sent,e(T(n.data.reverse())),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e(N(t.t0.message));case 10:return t.prev=10,e(I(!1)),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])})));return function(e){return t.apply(this,arguments)}}())}),[t]),Object(V.jsxs)("div",{className:"App",children:[n&&Object(V.jsx)(P.a,{color:"secondary",style:{position:"fixed",top:0,left:0,width:"100%",zIndex:99}}),e?Object(V.jsx)(A.a,{}):Object(V.jsx)(B.a,{fixed:!0,children:Object(V.jsxs)(Z.d,{children:[Object(V.jsx)(Z.b,{exact:!0,path:"/",render:function(){return Object(V.jsx)(Z.a,{to:"/posts"})}}),Object(V.jsx)(Z.b,{exact:!0,path:"/posts",render:function(){return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(Q,{}),Object(V.jsx)(U,{})]})}}),Object(V.jsx)(Z.b,{path:"/posts/:postId?",render:function(){return Object(V.jsx)(ot,{})}}),Object(V.jsx)(Z.b,{path:"/*",render:function(){return Object(V.jsx)("div",{children:"Page not found!"})}})]})}),Object(V.jsx)(it,{})]})}var ut=n(44),dt=n(87),pt=Object(ut.c)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET-POSTS":return Object(p.a)(Object(p.a)({},t),{},{posts:e.posts});case"SET-POST":return Object(p.a)(Object(p.a)({},t),{},{postData:e.post});case"ADD-POST":return Object(p.a)(Object(p.a)({},t),{},{posts:[e.post].concat(Object(d.a)(t.posts))});case"ADD-COMMENT":return Object(p.a)(Object(p.a)({},t),{},{postData:e.post});case"EDIT-POST":return Object(p.a)(Object(p.a)({},t),{},{postData:e.post,posts:t.posts.map((function(t){var n;return t.id===(null===(n=e.post)||void 0===n?void 0:n.id)?{id:e.post.id,title:e.post.title,body:e.post.body}:t}))});case"REMOVE-POST":return Object(p.a)(Object(p.a)({},t),{},{posts:t.posts.filter((function(t){return t.id!==e.postId})),postData:null});case"SET-INIT":return Object(p.a)(Object(p.a)({},t),{},{isInitializing:e.init});case"SET-LOADING":return Object(p.a)(Object(p.a)({},t),{},{isLoading:e.loading});case"SET-ERROR":return Object(p.a)(Object(p.a)({},t),{},{error:e.error});default:return t}}),Object(ut.a)(dt.a));window.store=pt;var bt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,180)).then((function(e){var n=e.getCLS,r=e.getFID,o=e.getFCP,a=e.getLCP,c=e.getTTFB;n(t),r(t),o(t),a(t),c(t)}))};c.a.render(Object(V.jsx)(o.a.StrictMode,{children:Object(V.jsx)(q.a,{children:Object(V.jsx)(s.a,{store:pt,children:Object(V.jsx)(lt,{})})})}),document.getElementById("root")),bt()}},[[128,1,2]]]);
//# sourceMappingURL=main.af512e3a.chunk.js.map